*****este archivo python fue copiado directamente del archivo funcional de descargas de html con imagenes y codigo source.html. Esta es la estructura de imagenes.


leer txt
â†“
crear carpeta
â†“
descargar HTML
â†“
guardar source



Nuevo codigo:

leer txt
â†“
extraer nombre del mp4
â†“
descargar en stream
â†“
guardar binario


*****el proceso de este codigo, no crea las carpetas usando el H1. ni descarga el codigo HTML.

-------------------------------------------------------
ğŸ”¥ CAMBIO 1 â€” Ya no necesitamos HTML ni BeautifulSoup

EliminarÃ­as:

from bs4 import BeautifulSoup


Y tambiÃ©n eliminarÃ­as toda esta parte:

# Guardar HTML SIEMPRE
ruta_html = os.path.join(ruta_carpeta, "source.html")
with open(ruta_html, "w", encoding="utf-8") as f:
    f.write(response.text)


Porque ya no trabajamos con HTML.

ğŸ”¥ CAMBIO 2 â€” Ya no necesitamos extraer H1

EliminarÃ­as:

limpiar_nombre() si solo vas a usar nombre desde URL.

nombre_desde_url() puede mantenerse (pero adaptado).

Toda lÃ³gica relacionada a H1.

ğŸ”¥ CAMBIO 3 â€” El request debe ser en modo stream

ANTES:

response = session.get(url, timeout=TIMEOUT)


AHORA debe ser:

response = session.get(url, timeout=TIMEOUT, stream=True)


Esto es obligatorio para video.

ğŸ”¥ CAMBIO 4 â€” Guardar en chunks (lo mÃ¡s importante)

ANTES guardabas texto:

f.write(response.text)


AHORA debes guardar binario:

with open(ruta_video, "wb") as f:
    for chunk in response.iter_content(chunk_size=1024 * 1024):
        if chunk:
            f.write(chunk)


Esto descarga 1MB por bloque.

ğŸ”¥ CAMBIO 5 â€” Obtener nombre del archivo desde la URL

Tu funciÃ³n actual:

def nombre_desde_url(url):


Sigue sirviendo.

Pero ahora:

Debe conservar .mp4

No reemplazarlo

No eliminar extensiÃ³n

Antes limpiabas .html.
Eso ya no aplica.

ğŸ”¥ CAMBIO 6 â€” Ya no necesitas crear carpeta por URL (opcional)

Si quieres algo simple:

ruta_video = os.path.join(BASE_DIR, nombre_archivo)


Sin subcarpetas.

ğŸ”¥ CAMBIO 7 â€” Manejo de archivos grandes

Opcional pero recomendable:

Verificar que realmente sea mp4:

if "video" not in response.headers.get("Content-Type", ""):
    print("âš ï¸ No parece un video real")


Esto evita guardar HTML como mp4 si el servidor responde error 403.

ğŸ”¥ CAMBIO 8 â€” Ajustar DELAY

Antes:

DELAY = 1.2


Para mp4 grandes puedes usar:

DELAY = 2


Porque cada request durarÃ¡ mucho mÃ¡s tiempo.

****Hecho por ChatGPT, no por mi------------